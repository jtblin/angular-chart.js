{"version":3,"file":"angular-chart.js","sources":["angular-chart.js"],"names":["chart","type","restrict","scope","id","data","labels","options","series","legend","click","link","elem","$watch","newVal","hasDataSets","length","datasets","forEach","dataset","i","points","map","point","j","value","segments","segment","update","getGraph","parent","append","generateLegend","cvs","document","getElementById","ctx","getContext","getDataSets","getData","Chart","onclick","evt","getPointsAtEvent","getSegmentsAtEvent","activePoints","indexOf","item","dataSet","clone","defaults","global","colours","label","obj","newObj","key","hasOwnProperty","color","strokeColor","highlight","pointHighlightStroke","responsive","fillColor","pointColor","pointStrokeColor","pointHighlightFill","angular","module","directive"],"mappings":"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","sourcesContent":["(function () {\n  \"use strict\";\n\n  Chart.defaults.global.responsive = true;\n\n  Chart.defaults.global.colours = [\n    { // blue\n      fillColor: \"rgba(151,187,205,0.2)\",\n      strokeColor: \"rgba(151,187,205,1)\",\n      pointColor: \"rgba(151,187,205,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(151,187,205,0.8)\"\n    },\n    { // light grey\n      fillColor: \"rgba(220,220,220,0.2)\",\n      strokeColor: \"rgba(220,220,220,1)\",\n      pointColor: \"rgba(220,220,220,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(220,220,220,0.8)\"\n    },\n    { // red\n      fillColor: \"rgba(247,70,74,0.2)\",\n      strokeColor: \"rgba(247,70,74,1)\",\n      pointColor: \"rgba(247,70,74,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(247,70,74,0.8)\"\n    },\n    { // green\n      fillColor: \"rgba(70,191,189,0.2)\",\n      strokeColor: \"rgba(70,191,189,1)\",\n      pointColor: \"rgba(70,191,189,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(70,191,189,0.8)\"\n    },\n    { // yellow\n      fillColor: \"rgba(253,180,92,0.2)\",\n      strokeColor: \"rgba(253,180,92,1)\",\n      pointColor: \"rgba(253,180,92,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(253,180,92,0.8)\"\n    },\n    { // grey\n      fillColor: \"rgba(148,159,177,0.2)\",\n      strokeColor: \"rgba(148,159,177,1)\",\n      pointColor: \"rgba(148,159,177,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(148,159,177,0.8)\"\n    },\n    { // dark grey\n      fillColor: \"rgba(77,83,96,0.2)\",\n      strokeColor: \"rgba(77,83,96,1)\",\n      pointColor: \"rgba(77,83,96,1)\",\n      pointStrokeColor: \"#fff\",\n      pointHighlightFill: \"#fff\",\n      pointHighlightStroke: \"rgba(77,83,96,1)\"\n    }\n  ];\n\n  angular.module(\"charts\", [])\n    .directive(\"chartLine\", function () { return chart('Line'); })\n    .directive(\"chartBar\", function () { return chart('Bar'); })\n    .directive(\"chartRadar\", function () { return chart('Radar'); })\n    .directive(\"chartDoughnut\", function () { return chart('Doughnut'); })\n    .directive(\"chartPie\", function () { return chart('Pie'); })\n    .directive(\"chartPolarArea\", function () { return chart('PolarArea'); });\n\n  function chart (type) {\n    return {\n      restrict: 'CA',\n      scope: {\n        id: '@',\n        data: '=',\n        labels: '=',\n        options: '=',\n        series: '=',\n        legend: '@',\n        click: '='\n      },\n      link: function (scope, elem, attrs) {\n        var chart;\n\n        scope.$watch('data', function (newVal, oldVal) {\n          if (hasDataSets(type) && ! newVal[0].length) return;\n          if (! chart) {\n            chart = getGraph(type, scope);\n            if (scope.legend) {\n              elem.parent().append(chart.generateLegend());\n            }\n          } else {\n            if (hasDataSets(type)){\n              chart.datasets.forEach(function (dataset, i) {\n                dataset.points = dataset.points.map(function (point, j) {\n                  point.value = newVal[i][j];\n                  return point;\n                });\n              });\n            } else {\n              chart.segments.forEach(function (segment, i) {\n                segment.value = newVal[i];\n              });\n            }\n            chart.update();\n          }\n        }, true);\n      }\n    };\n  }\n\n  function getGraph (type, scope) {\n    var cvs = document.getElementById(scope.id), ctx = cvs.getContext(\"2d\");\n    var data = hasDataSets(type) ? getDataSets(scope.labels, scope.data, scope.series || []) : getData(scope.labels, scope.data);\n    var chart = new Chart(ctx)[type](data, scope.options || {});\n    if (scope.click) {\n      cvs.onclick = function (evt) {\n        if (chart.getPointsAtEvent || chart.getSegmentsAtEvent) {\n          var activePoints = hasDataSets(type) ? chart.getPointsAtEvent(evt) : chart.getSegmentsAtEvent(evt);\n          scope.click(activePoints, evt);\n        }\n      };\n    }\n    return chart;\n  }\n\n  function hasDataSets (type) {\n    return ['Line', 'Bar', 'Radar'].indexOf(type) > -1;\n  }\n\n  function getDataSets (labels, data, series) {\n    return {\n      labels: labels,\n      datasets: data.map(function (item, i) {\n        var dataSet = clone(Chart.defaults.global.colours[i]);\n        dataSet.label = series[i];\n        dataSet.data = item;\n        return dataSet;\n      })\n    };\n  }\n\n  function clone (obj) {\n    var newObj = {};\n    for (var key in obj) {\n      if (obj.hasOwnProperty(key)) newObj[key] = obj[key];\n    }\n    return newObj;\n  }\n\n  function getData (labels, data) {\n    return labels.map(function (label, i) {\n      return {\n        label: label,\n        value: data[i],\n        color: Chart.defaults.global.colours[i].strokeColor,\n        highlight: Chart.defaults.global.colours[i].pointHighlightStroke\n      };\n    });\n  }\n\n})();"],"sourceRoot":"/source/"}