!function(t,e){"use strict";function r(t,e){var r,i;if("function"==typeof e)i=e(t),void 0!==i&&(t=i);else if(Array.isArray(e))for(r=0;r<e.length;r++)i=e[r](t),void 0!==i&&(t=i);return t}function i(t,e){return"-"===t[0]&&Array.isArray(e)&&/^-\d+$/.test(t)?e.length+parseInt(t,10):t}function n(t){return/^\d+/.test(t)}function o(t,e){return t.indexOf("[")>=0&&(t=t.replace(/\[/g,".").replace(/]/g,"")),t.split(e)}function s(t,e,r){return this instanceof s?("undefined"==typeof t&&(t="."),"undefined"==typeof e&&(e=!1),"undefined"==typeof r&&(r=!0),this.seperator=t,this.override=e,this.useArray=r,void(this.cleanup=[])):new s(t,e,r)}function f(t){return function(){return c[t].apply(c,arguments)}}function p(t){return"[object Object]"===Object.prototype.toString.call(t)}var c=new s(".",!1,!0);s.prototype._fill=function(t,e,i,o){var s=t.shift();if(t.length>0){if(e[s]=e[s]||(this.useArray&&n(t[0])?[]:{}),e[s]!==Object(e[s])){if(!this.override)throw new Error("Trying to redefine `"+s+"` which is a "+typeof e[s]);e[s]={}}this._fill(t,e[s],i,o)}else{if(!this.override&&e[s]===Object(e[s])&&Object.keys(e[s]).length)throw new Error("Trying to redefine non-empty obj['"+s+"']");e[s]=r(i,o)}},s.prototype.object=function(t,e){var i=this;return Object.keys(t).forEach(function(n){var s=void 0===e?null:e[n],f=o(n,i.seperator).join(i.seperator);-1!==f.indexOf(i.seperator)?(i._fill(f.split(i.seperator),t,t[n],s),delete t[n]):i.override&&(t[n]=r(t[n],s))}),t},s.prototype.str=function(t,e,i,n){return-1!==t.indexOf(this.seperator)?this._fill(t.split(this.seperator),i,e,n):this.override&&(i[t]=r(e,n)),i},s.prototype.pick=function(t,e,r){var n,s,f,p,c;for(s=o(t,this.seperator),n=0;n<s.length;n++){if(p=i(s[n],e),!(e&&"object"==typeof e&&p in e))return;if(n===s.length-1)return r?(f=e[p],delete e[p],Array.isArray(e)&&(c=s.slice(0,-1).join("."),-1===this.cleanup.indexOf(c)&&this.cleanup.push(c)),f):e[p];e=e[p]}return r&&Array.isArray(e)&&(e=e.filter(function(t){return void 0!==t})),e},s.prototype.remove=function(t,e){var r;if(this.cleanup=[],Array.isArray(t)){for(r=0;r<t.length;r++)this.pick(t[r],e,!0);return this._cleanup(e),e}return this.pick(t,e,!0)},s.prototype._cleanup=function(t){var e,r,i,n;if(this.cleanup.length){for(r=0;r<this.cleanup.length;r++)i=this.cleanup[r].split("."),n=i.splice(0,-1).join("."),e=n?this.pick(n,t):t,e=e[i[0]].filter(function(t){return void 0!==t}),this.set(this.cleanup[r],e,t);this.cleanup=[]}},s.prototype.del=s.prototype.remove,s.prototype.move=function(t,e,i,n,o){return"function"==typeof n||Array.isArray(n)?this.set(e,r(this.pick(t,i,!0),n),i,o):(o=n,this.set(e,this.pick(t,i,!0),i,o)),i},s.prototype.transfer=function(t,e,i,n,o,s){return"function"==typeof o||Array.isArray(o)?this.set(e,r(this.pick(t,i,!0),o),n,s):(s=o,this.set(e,this.pick(t,i,!0),n,s)),n},s.prototype.copy=function(t,e,i,n,o,s){return"function"==typeof o||Array.isArray(o)?this.set(e,r(JSON.parse(JSON.stringify(this.pick(t,i,!1))),o),n,s):(s=o,this.set(e,this.pick(t,i,!1),n,s)),n},s.prototype.set=function(t,e,r,i){var n,s,f,c;if("undefined"==typeof e)return r;for(f=o(t,this.seperator),n=0;n<f.length;n++){if(c=f[n],n===f.length-1)if(i&&p(e)&&p(r[c]))for(s in e)e.hasOwnProperty(s)&&(r[c][s]=e[s]);else if(i&&Array.isArray(r[c])&&Array.isArray(e))for(var u=0;u<e.length;u++)r[f[n]].push(e[u]);else r[c]=e;else r.hasOwnProperty(c)&&(p(r[c])||Array.isArray(r[c]))||(/^\d+$/.test(f[n+1])?r[c]=[]:r[c]={});r=r[c]}return r},s.prototype.transform=function(t,e,r){return e=e||{},r=r||{},Object.keys(t).forEach(function(i){this.set(t[i],this.pick(i,e),r)}.bind(this)),r},s.prototype.dot=function(t,e,r){return e=e||{},r=r||[],Object.keys(t).forEach(function(i){return Object(t[i])===t[i]?this.dot(t[i],e,r.concat(i)):void(e[r.concat(i).join(this.seperator)]=t[i])}.bind(this)),e},s.pick=f("pick"),s.move=f("move"),s.transfer=f("transfer"),s.transform=f("transform"),s.copy=f("copy"),s.object=f("object"),s.str=f("str"),s.set=f("set"),s.del=s.remove=f("remove"),s.dot=f("dot"),["override","overwrite"].forEach(function(t){Object.defineProperty(s,t,{get:function(){return c.override},set:function(t){c.override=!!t}})}),Object.defineProperty(s,"useArray",{get:function(){return c.useArray},set:function(t){c.useArray=t}}),s._process=r,"function"==typeof define&&define.amd?define(function(){return s}):"undefined"!=typeof module&&module.exports?module.exports=s:t[e]=s}(this,"DotObject");